
<MudPaper Width="100%" Elevation="0" >
	<MudStack Justify="Justify.Center">
		<MudContainer MaxWidth="MaxWidth.Small">

			<MudPaper Elevation="2">
				Add Instruction
				<EditForm Model="Model" OnValidSubmit="OnValidSubmit">
					<DataAnnotationsValidator />
					<ValidationSummary /> 
					<MudToolBar>
						<MudButtonGroup Variant="Variant.Outlined" Class="d-flex align-center flex-grow-1" Elevation="0">
							<MudButton  ButtonType="ButtonType.Submit" Variant="Variant.Text" Size="Size.Medium">Add</MudButton>
							<MudButton ButtonType="ButtonType.Submit" Variant="Variant.Text" OnClick="@(() => Model = new InstructionDisplayModel())" Size="Size.Medium">Reset</MudButton>

						</MudButtonGroup>
					</MudToolBar>



					@if (!String.IsNullOrEmpty(ErrorText))
					{
						<MudAlert Severity="Severity.Warning">@ErrorText</MudAlert>
					}

					<CascadingValue Value="Model.Ingredient">
						<IngredientDropDown OnSelectIngredient="OnSelectIngredientChange"></IngredientDropDown>
					</CascadingValue>
					<MudTextField Class="px-10" @bind-Value="Model.Oz" Label="Oz" Variant="Variant.Text"></MudTextField>
					<MudTextField Class="px-10" @bind-Value="Model.Special" Label="Special" Variant="Variant.Text"></MudTextField>
					<MudSelect Class="px-10" T="bool" Label="Optional Flags" AnchorOrigin="Origin.BottomCenter">
						<MudSelectItem Value="@(ShakeOrServe = true)">Shake Flags</MudSelectItem>
						<MudSelectItem Value="@(ShakeOrServe = false)">Serving Flags</MudSelectItem>
					</MudSelect>
					

					@if (ShakeOrServe)
					{
						@if (ShakerFlags.Count() != 0)
						{
							<MudContainer>
								<MudChipSet @bind-SelectedChip="ShakerSelected" Filter="true" Mandatory="true">
									<MudGrid Spacing="2" Class="pa-md-6 mx-lg-auto">
										@foreach (FlagDisplayModel f in ShakerFlags)
										{
											<MudChip Text="@f.Name" Value="f" />
										}
									</MudGrid>
								</MudChipSet>
							</MudContainer>

						}
						else
						{
							<MudText>
								No Flags Found
							</MudText>
						}
					}
					else
					{
						@if (ServingFlags.Count() != 0)
						{
							<MudContainer>
								<MudChipSet @bind-SelectedChip="ServingSelected" Filter="true" Mandatory="true">
									<MudGrid Spacing="2" Class="pa-md-6 mx-lg-auto">
										@foreach (FlagDisplayModel f in ServingFlags)
										{
											<MudChip Text="@f.Name" Value="f" />
										}
									</MudGrid>
								</MudChipSet>
							</MudContainer>
						}
					}


					<CascadingValue Value="Model.Tags">
						<Tagging OnSelectTag="OnSelectTag"
								 TagType="@nameof(InstructionDisplayModel)"></Tagging>
					</CascadingValue>
				</EditForm>
			</MudPaper>
		</MudContainer>
	</MudStack>
</MudPaper>

