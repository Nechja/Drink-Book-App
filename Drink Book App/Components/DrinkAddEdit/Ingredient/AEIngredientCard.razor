@attribute [Authorize(Roles = "Admin, Mod")]
@page "/drinktools/ingredients"


<MudContainer>
 <MudPaper Elevation="0" >
	<MudPaper Elevation="0">
		<EditForm Model="@Ingredient" 
				OnValidSubmit="HandleValidSubmit" 
				OnInvalidSubmit="HandleInvalidSubmit">
		<DataAnnotationsValidator />
		<ValidationSummary />
			@if (!String.IsNullOrEmpty(ErrorText))
			{
				<MudAlert Severity="Severity.Warning">@ErrorText</MudAlert>
			}
		<MudStack Spacing="3">
		<MudPaper Elevation="0">
			<MudCardHeader>Ingredient</MudCardHeader>
			<MudCardContent >
					<MudTextField @bind-Value="Ingredient.Name" Label="Ingredient Name" Variant="Variant.Text" @onkeypress=KeyStop></MudTextField>
					<CascadingValue Value="Ingredient.IngredientType">
						<IngredientTypeDropDown OnSelectIngredient="OnSelectIngredientChange" />
					</CascadingValue>
			</MudCardContent>
		</MudPaper>
			</MudStack>
			<MudDivider DividerType="DividerType.FullWidth" />

		@if (Ingredient.Id == 0)
		{
				<input type="submit" class="btn btn-dark" @onkeypress="KeyStop" value="Add" />
		}
		else
		{
				<input type="submit" class="btn btn-dark" @onkeypress="KeyStop" value="Edit" />
		}
	</EditForm>
	</MudPaper>
		@if (Ingredients is null)
		{
			<MudProgressLinear Color="Color.Primary" Indeterminate="true" Class="my-7" />
		}
		else
		{
	<MudCard>
		<MudCardContent>
			<MudList>
					@foreach (IngredientDisplayModel i in Ingredients)
					{
						<MudPaper Elevation="1" Square="true">
							<MudStack Row="true" Justify="Justify.SpaceBetween">
								<MudPaper Elevation="0">
									<MudChip Label="true" Color="Color.Transparent" Variant="Variant.Text" Text="@i.Name"></MudChip>
								</MudPaper>
								<MudButtonGroup Color="Color.Dark" Variant="Variant.Text">
									<MudIconButton Icon="@Icons.Material.Filled.Delete" aria-label="delete"></MudIconButton>
									<MudIconButton Icon="@Icons.Material.Filled.Edit" aria-label="edit" @onclick="() => OnEdit(i)"></MudIconButton>
								</MudButtonGroup>

							</MudStack>
							<MudPaper>
							</MudPaper>
						</MudPaper>
					}
			</MudList>
		</MudCardContent>
	</MudCard>
		}

</MudPaper>
</MudContainer>